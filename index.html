<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Toâ€‘Do List (Local Storage)</title>
  <style>
    :root{--bg:#f7f8fc;--card:#ffffff;--accent:#4f46e5;--muted:#6b7280}
    *{box-sizing:border-box}
    body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial; background:var(--bg); margin:0; padding:32px}
    .container{max-width:760px;margin:0 auto}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px}
    h1{font-size:20px;color:#111827}
    .card{background:var(--card);border-radius:12px;box-shadow:0 6px 18px rgba(17,24,39,0.06);padding:18px}

    form{display:flex;gap:8px}
    input[type="text"]{flex:1;padding:12px;border:1px solid #e6e9ef;border-radius:8px;font-size:15px}
    button{background:var(--accent);color:white;border:none;padding:10px 14px;border-radius:8px;font-weight:600;cursor:pointer}
    button:active{transform:translateY(1px)}

    .controls{display:flex;justify-content:space-between;align-items:center;margin:14px 0}
    .filters{display:flex;gap:8px}
    .filters button{background:transparent;border:1px solid #e6e9ef;padding:6px 10px;border-radius:8px;cursor:pointer}
    .filters button.active{border-color:var(--accent);color:var(--accent);font-weight:700}

    ul.todo-list{list-style:none;padding:0;margin:0}
    li.todo{display:flex;align-items:center;gap:12px;padding:12px;border-radius:8px;border:1px solid #f1f3f5;margin-bottom:10px}
    li.todo.completed{opacity:0.6;text-decoration:line-through}

    .todo-left{display:flex;align-items:center;gap:12px;flex:1}
    .todo-checkbox{width:18px;height:18px;border:2px solid #cbd5e1;border-radius:4px;display:inline-block;cursor:pointer}
    .todo-title{font-size:15px;color:#111827}

    .todo-actions{display:flex;gap:8px}
    .icon-btn{background:transparent;border:0;padding:6px;border-radius:6px;cursor:pointer}
    .small{font-size:13px;color:var(--muted)}

    .meta{display:flex;justify-content:space-between;align-items:center;margin-top:12px;color:var(--muted);font-size:13px}

    @media (max-width:520px){body{padding:16px}header h1{font-size:18px}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Toâ€‘Do List (saved in your browser)</h1>
      <div class="small">LocalStorage â€¢ No account required</div>
    </header>

    <div class="card">
      <form id="todo-form" aria-label="Add todo">
        <input id="todo-input" type="text" placeholder="Add a new task and press Add" autocomplete="off" />
        <button id="add-btn" type="submit">Add</button>
      </form>

      <div class="controls">
        <div class="filters" role="tablist" aria-label="Filter todos">
          <button data-filter="all" class="filter-btn active">All</button>
          <button data-filter="active" class="filter-btn">Active</button>
          <button data-filter="completed" class="filter-btn">Completed</button>
        </div>
        <div>
          <button id="clear-completed" class="icon-btn">Clear completed</button>
          <button id="export-json" class="icon-btn">Export</button>
          <button id="import-json" class="icon-btn">Import</button>
        </div>
      </div>

      <ul id="todo-list" class="todo-list" aria-live="polite"></ul>

      <div class="meta">
        <div id="count">0 items</div>
        <div>
          <button id="clear-all" class="icon-btn">Clear all</button>
        </div>
      </div>
    </div>

    <p style="text-align:center;margin-top:14px;color:var(--muted);font-size:13px">Tip: your tasks are stored only on this browser â€” clearing site data will remove them.</p>
  </div>

  <script>
    // Simple To-Do app using localStorage. No frameworks.
    const KEY = 'todo_app_v1';
    const form = document.getElementById('todo-form');
    const input = document.getElementById('todo-input');
    const list = document.getElementById('todo-list');
    const countEl = document.getElementById('count');
    const clearAllBtn = document.getElementById('clear-all');
    const clearCompletedBtn = document.getElementById('clear-completed');
    const exportBtn = document.getElementById('export-json');
    const importBtn = document.getElementById('import-json');
    const filterBtns = document.querySelectorAll('.filter-btn');

    let todos = JSON.parse(localStorage.getItem(KEY) || '[]');
    let filter = 'all';

    // Utility: save to localStorage
    function save() {
      localStorage.setItem(KEY, JSON.stringify(todos));
    }

    // Render list based on filter
    function render() {
      list.innerHTML = '';
      const filtered = todos.filter(t => {
        if (filter === 'all') return true;
        if (filter === 'active') return !t.completed;
        if (filter === 'completed') return t.completed;
      });

      for (const t of filtered) {
        const li = document.createElement('li');
        li.className = 'todo' + (t.completed ? ' completed' : '');
        li.dataset.id = t.id;

        // Left area
        const left = document.createElement('div');
        left.className = 'todo-left';

        const checkbox = document.createElement('div');
        checkbox.className = 'todo-checkbox';
        checkbox.setAttribute('role','checkbox');
        checkbox.setAttribute('aria-checked', String(!!t.completed));
        checkbox.addEventListener('click', () => toggleComplete(t.id));

        const title = document.createElement('div');
        title.className = 'todo-title';
        title.textContent = t.text;
        title.contentEditable = true;
        title.addEventListener('blur', (e) => {
          const updated = e.target.textContent.trim();
          if (updated === '') {
            // if cleared, revert
            e.target.textContent = t.text;
          } else if (updated !== t.text) {
            editTodo(t.id, updated);
          }
        });
        title.addEventListener('keydown', (e) => {
          if (e.key === 'Enter') { e.preventDefault(); title.blur(); }
        });

        left.appendChild(checkbox);
        left.appendChild(title);

        // Actions
        const actions = document.createElement('div');
        actions.className = 'todo-actions';

        const editBtn = document.createElement('button');
        editBtn.className = 'icon-btn';
        editBtn.title = 'Edit';
        editBtn.textContent = 'âœï¸';
        editBtn.addEventListener('click', () => {
          title.focus();
        });

        const delBtn = document.createElement('button');
        delBtn.className = 'icon-btn';
        delBtn.title = 'Delete';
        delBtn.textContent = 'ðŸ—‘ï¸';
        delBtn.addEventListener('click', () => removeTodo(t.id));

        actions.appendChild(editBtn);
        actions.appendChild(delBtn);

        li.appendChild(left);
        li.appendChild(actions);

        list.appendChild(li);
      }

      countEl.textContent = `${todos.length} item${todos.length!==1 ? 's' : ''}`;

      // update active filter button styles
      filterBtns.forEach(b => b.classList.toggle('active', b.dataset.filter === filter));
    }

    // Add
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const text = input.value.trim();
      if (!text) return;
      const todo = { id: Date.now().toString(), text, completed: false };
      todos.unshift(todo);
      save();
      input.value = '';
      render();
    });

    // Toggle complete
    function toggleComplete(id) {
      todos = todos.map(t => t.id === id ? {...t, completed: !t.completed} : t);
      save();
      render();
    }

    // Edit
    function editTodo(id, newText) {
      todos = todos.map(t => t.id === id ? {...t, text: newText} : t);
      save();
      render();
    }

    // Remove
    function removeTodo(id) {
      todos = todos.filter(t => t.id !== id);
      save();
      render();
    }

    // Clear all
    clearAllBtn.addEventListener('click', () => {
      if (!confirm('Clear ALL tasks?')) return;
      todos = [];
      save();
      render();
    });

    // Clear completed
    clearCompletedBtn.addEventListener('click', () => {
      todos = todos.filter(t => !t.completed);
      save();
      render();
    });

    // Filters
    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        filter = btn.dataset.filter;
        render();
      });
    });

    // Export JSON (download file)
    exportBtn.addEventListener('click', () => {
      const blob = new Blob([JSON.stringify(todos, null, 2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = 'todos.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    // Import JSON (simple prompt)
    importBtn.addEventListener('click', () => {
      const text = prompt('Paste JSON array of todos (or leave empty to cancel)');
      if (!text) return;
      try {
        const data = JSON.parse(text);
        if (!Array.isArray(data)) throw new Error('Not an array');
        // normalize
        todos = data.map(d => ({ id: d.id?.toString() || Date.now().toString(), text: String(d.text||''), completed: !!d.completed }));
        save(); render();
        alert('Imported ' + todos.length + ' items');
      } catch (err) {
        alert('Invalid JSON: ' + err.message);
      }
    });

    // Initial render
    render();

    // Accessibility: allow keyboard submit with Enter
    input.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        form.requestSubmit();
      }
    });
  </script>
</body>
</html>
